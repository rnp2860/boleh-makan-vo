# ğŸ©º Dr. Reza AI - Visual Reference Card

## ğŸ¯ The Upgrade at a Glance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BEFORE: Generic Advice                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  User: Has Diabetes + Hypertension                          â”‚
â”‚  Food: Nasi Lemak (580 cal, 58g carbs, 720mg sodium)       â”‚
â”‚                                                              â”‚
â”‚  Dr. Reza Says:                                             â”‚
â”‚  "This Nasi Lemak has high calories and carbs.              â”‚
â”‚   Try to eat in moderation."                                â”‚
â”‚                                                              â”‚
â”‚  âŒ Mentions only 1-2 nutrients                             â”‚
â”‚  âŒ No condition-specific warnings                          â”‚
â”‚  âŒ No today's context                                      â”‚
â”‚  âŒ Generic advice                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            â¬‡ï¸  UPGRADE  â¬‡ï¸

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AFTER: Multi-Condition Analysis                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Same User & Food                                           â”‚
â”‚                                                              â”‚
â”‚  Dr. Reza Says:                                             â”‚
â”‚  "Nasi Lemak - ğŸŸ¡ BERHATI-HATI                             â”‚
â”‚                                                              â”‚
â”‚   Untuk keadaan anda:                                       â”‚
â”‚                                                              â”‚
â”‚   â€¢ ğŸ©¸ Diabetes: At 58g carbs, expect glucose spike to     â”‚
â”‚     9-11 mmol/L in 45 mins. You've had 95g carbs today     â”‚
â”‚     (53% of 180g target).                                   â”‚
â”‚                                                              â”‚
â”‚   â€¢ ğŸ’‰ Darah Tinggi: Contains 720mg sodium (36% of         â”‚
â”‚     daily limit). Combined with 1150mg already today,       â”‚
â”‚     you'll be at 94% of limit. BP may spike.                â”‚
â”‚                                                              â”‚
â”‚   Tips: Cuba minta 'kuah sikit', skip extra sambal.        â”‚
â”‚   Consider lighter dinner - grilled fish with ulam!"        â”‚
â”‚                                                              â”‚
â”‚  âœ… Analyzes ALL conditions                                 â”‚
â”‚  âœ… Specific predictions with numbers                       â”‚
â”‚  âœ… Today's cumulative intake                               â”‚
â”‚  âœ… Malaysian alternatives                                  â”‚
â”‚  âœ… Actionable advice                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Features Comparison

| Feature | Before | After |
|---------|--------|-------|
| **Conditions Analyzed** | 1 (50%) | All (100%) |
| **Specific Numbers** | Rare | Always |
| **Glucose Predictions** | âŒ | âœ… 9-11 mmol/L |
| **Today's Context** | âŒ | âœ… With % |
| **Malaysian Swaps** | Sometimes | Always |
| **Tone** | Clinical | Warm & Friendly |
| **Food Name Memory** | âŒ Lost on edit | âœ… Preserved |

---

## ğŸš€ Implementation Checklist

### âœ… Files Added
- [ ] `lib/ai/dr-reza-prompt.ts`
- [ ] `lib/user/health-profile.ts`

### âœ… Files Updated
- [ ] `app/api/chat-dr-reza/route.ts`

### âœ… Frontend Integration
```typescript
// In your meal logging component
{
  useEnhancedPrompt: true, // â† Add this
  mealContext: {           // â† Add this
    foodName: food.name_en,
    originalFoodName: food.name_en,
    serving: `${multiplier}x ${food.serving_description}`,
    nutrition: { /* all nutrients */ },
    ...getConditionRatingsFromFood(food),
  }
}
```

### âœ… Testing
- [ ] Multi-condition user â†’ mentions all conditions
- [ ] Edit meal â†’ preserves food name
- [ ] Today's intake â†’ shows cumulative totals
- [ ] Malaysian alternatives â†’ suggested

---

## ğŸ’¡ Key Concepts

### 1. Multi-Condition Analysis
```
User has: [Diabetes, Hypertension, Cholesterol]

Dr. Reza analyzes food against:
âœ… Diabetes   â†’ Carbs, sugar, GI
âœ… Hypertension â†’ Sodium
âœ… Cholesterol â†’ Sat fat, trans fat

NOT just one!
```

### 2. Context Preservation
```typescript
// âŒ Wrong - loses context
mealContext: {
  foodName: 'nasi lemak', // User typed this
}

// âœ… Right - preserves original
mealContext: {
  foodName: originalFoodName, // "Nasi Lemak Rendang Ayam"
  originalFoodName: 'Nasi Lemak Rendang Ayam',
}
```

### 3. Today's Awareness
```
Already eaten today:
- 1200 cal (60% of 2000 target)
- 95g carbs (53% of 180g target)
- 1150mg sodium (58% of 2000mg target)

New meal adds:
- 580 cal â†’ Total: 1780 cal (89%)
- 58g carbs â†’ Total: 153g (85%)
- 720mg sodium â†’ Total: 1870mg (94%) âš ï¸

Dr. Reza warns about approaching sodium limit!
```

---

## ğŸ¯ Traffic Light System

### ğŸŸ¢ SELAMAT (Safe)
- All conditions: Safe levels
- No warnings needed
- Encourage this choice

### ğŸŸ¡ BERHATI-HATI (Caution)
- Some conditions: Moderate risk
- Watch portions
- Provide specific tips

### ğŸ”´ HADKAN (Limit)
- Multiple conditions: High risk
- Limit intake
- Suggest alternatives

---

## ğŸ“± Response Format

```markdown
**[FOOD NAME]** - Overall: ğŸŸ¢/ğŸŸ¡/ğŸ”´

**Untuk keadaan anda:**

â€¢ ğŸ©¸ **Diabetes**: [Specific impact with numbers]
â€¢ ğŸ’‰ **Darah Tinggi**: [Specific impact with numbers]
â€¢ ğŸ’Š **Kolesterol**: [Specific impact with numbers]
â€¢ ğŸ«˜ **Buah Pinggang**: [Specific impact with numbers]

**Overall:** [Summary assessment]

**Tips:** [One actionable Malaysian suggestion]
```

---

## ğŸ”§ Quick Troubleshooting

| Problem | Solution |
|---------|----------|
| Only 1 condition mentioned | Set `useEnhancedPrompt: true` |
| Food name gets shortened | Preserve `originalFoodName` |
| Today's intake shows 0 | Check `food_logs` table |
| No response | Verify OpenAI API key |
| Generic advice | Include `mealContext` |

---

## ğŸ“š Documentation Files

1. **DR_REZA_AI_UPGRADE.md** (19KB)
   - Complete technical docs
   - Architecture diagrams
   - Database schema
   - Testing guide

2. **DR_REZA_QUICK_START.md** (10KB)
   - 30-second overview
   - 3-step implementation
   - Code examples

3. **DR_REZA_IMPLEMENTATION_SUMMARY.md** (12KB)
   - Executive summary
   - Migration steps
   - Success metrics

---

## ğŸ‰ Ready to Deploy!

```bash
# 1. Copy files
cp lib/ai/dr-reza-prompt.ts [your-project]/lib/ai/
cp lib/user/health-profile.ts [your-project]/lib/user/

# 2. Update API
# Modify app/api/chat-dr-reza/route.ts

# 3. Update frontend
# Add useEnhancedPrompt + mealContext

# 4. Test
npm run dev
```

### Total Time: ~30 minutes

---

## âœ… Success Criteria

After implementation, verify:

- [ ] Multi-condition user sees analysis for ALL conditions
- [ ] Specific predictions provided (e.g., "9-11 mmol/L")
- [ ] Today's cumulative intake shown with percentages
- [ ] Malaysian alternatives suggested (not Western)
- [ ] Food name preserved when editing servings
- [ ] Response is warm and encouraging
- [ ] No medical diagnoses given
- [ ] Concise (2-3 paragraphs max)

---

**Print this card for quick reference!**

ğŸ‡²ğŸ‡¾ **Helping Malaysians live healthier lives!** ğŸ©º

